{"Flow":{"$":{"xmlns":"http://soap.sforce.com/2006/04/metadata"},"actionCalls":[{"name":["Send_Notification"],"label":["Send Notification"],"locationX":["204"],"locationY":["2567"],"actionName":["customNotificationAction"],"actionType":["customNotificationAction"],"connector":[{"targetReference":["Assign_Current_ID"]}],"flowTransactionModel":["CurrentTransaction"],"inputParameters":[{"name":["customNotifTypeId"],"value":[{"elementReference":["Custom_Notification_Type.Id"]}]},{"name":["body"],"value":[{"elementReference":["ClosedForTimecardNotification"]}]},{"name":["title"],"value":[{"stringValue":["Project closed for Timecard Entry"]}]},{"name":["recipientIds"],"value":[{"elementReference":["SFUserListTXT"]}]},{"name":["targetId"],"value":[{"elementReference":["$Record.Id"]}]}],"nameSegment":["customNotificationAction"],"versionSegment":["1"]}],"apiVersion":["56.0"],"assignments":[{"name":["AddToFinalList"],"label":["AddToFinalList"],"locationX":["204"],"locationY":["2459"],"assignmentItems":[{"assignToReference":["SFUserListTXT"],"operator":["Add"],"value":[{"elementReference":["GetUserList.Id"]}]}],"connector":[{"targetReference":["Send_Notification"]}]},{"name":["Approval_Status_WAR_Closed"],"label":["Approval Status = WAR Closed"],"locationX":["270"],"locationY":["539"],"assignmentItems":[{"assignToReference":["Get_Active_Renewed_Work_At_Risks.FFPSA_ApprovalStatus__c"],"operator":["Assign"],"value":[{"stringValue":["WAR closed"]}]}],"connector":[{"targetReference":["Update_ProjWARs"]}]},{"name":["Assign_Current_ID"],"label":["Assign Current ID"],"locationX":["336"],"locationY":["2759"],"assignmentItems":[{"assignToReference":["previousresourceid"],"operator":["Assign"],"value":[{"elementReference":["GetUserList.Id"]}]}],"connector":[{"targetReference":["FFPSA_Loop_through_Assignments"]}]},{"name":["AssignmentsFromProject"],"label":["AssignmentsFromProject"],"locationX":["116"],"locationY":["1379"],"assignmentItems":[{"assignToReference":["ResourcesFromAssignments"],"operator":["Add"],"value":[{"elementReference":["FFPSA_Get_Assignments_from_Project"]}]}],"connector":[{"targetReference":["FFPSA_SortAssignments"]}]},{"name":["CustomNotificationType"],"label":["CustomNotificationType"],"locationX":["204"],"locationY":["2135"],"assignmentItems":[{"assignToReference":["CustomerNotificationTypeID"],"operator":["Assign"],"value":[{"elementReference":["Custom_Notification_Type.Id"]}]}],"connector":[{"targetReference":["UserIDToUse"]}]},{"name":["NotificationBody"],"label":["NotificationBody"],"locationX":["204"],"locationY":["2351"],"assignmentItems":[{"assignToReference":["NotificationBodyText"],"operator":["Assign"],"value":[{"elementReference":["ClosedForTimecardNotification"]}]}],"connector":[{"targetReference":["AddToFinalList"]}]},{"name":["Populate_BillRateFixFee_on_Assignment_from_Suggested_Bill_Rate"],"label":["Populate BillRateFixFee on Assignment from Suggested Bill Rate"],"locationX":["534"],"locationY":["3743"],"assignmentItems":[{"assignToReference":["Loop_through_Assignments_on_projectV2.FFPSA_BillRateFixFee__c"],"operator":["Assign"],"value":[{"elementReference":["Loop_through_Assignments_on_projectV2.pse__Suggested_Bill_Rate_Number__c"]}]},{"assignToReference":["vAssignmentCollections"],"operator":["Add"],"value":[{"elementReference":["Loop_through_Assignments_on_projectV2"]}]}],"connector":[{"targetReference":["Loop_through_Assignments_on_projectV2"]}]},{"name":["Populate_field_BillRateFixFee_on_Assignment_as_0"],"label":["Populate field BillRateFixFee on Assignment as 0"],"locationX":["138"],"locationY":["3743"],"assignmentItems":[{"assignToReference":["Loop_through_Assignments_on_project.FFPSA_BillRateFixFee__c"],"operator":["Assign"],"value":[{"numberValue":["0.0"]}]},{"assignToReference":["vAssignmentCollections"],"operator":["Add"],"value":[{"elementReference":["Loop_through_Assignments_on_project"]}]}],"connector":[{"targetReference":["Loop_through_Assignments_on_project"]}]},{"name":["UserIDToUse"],"label":["UserIDToUse"],"locationX":["204"],"locationY":["2243"],"assignmentItems":[{"assignToReference":["previousresourceid"],"operator":["Assign"],"value":[{"elementReference":["GetUserList.Id"]}]}],"connector":[{"targetReference":["NotificationBody"]}]}],"collectionProcessors":[{"name":["FFPSA_SortAssignments"],"elementSubtype":["SortCollectionProcessor"],"label":["SortAssignments"],"locationX":["116"],"locationY":["1487"],"collectionProcessorType":["SortCollectionProcessor"],"collectionReference":["ResourcesFromAssignments"],"connector":[{"targetReference":["FFPSA_Loop_through_Assignments"]}],"sortOptions":[{"doesPutEmptyStringAndNullFirst":["false"],"sortField":["pse__Resource__c"],"sortOrder":["Asc"]}]}],"decisions":[{"name":["Check_If_Assignments_are_not_null"],"label":["Check If Assignments are not null"],"locationX":["446"],"locationY":["3935"],"defaultConnectorLabel":["Default Outcome"],"rules":[{"name":["If_Not_Null"],"conditionLogic":["and"],"conditions":[{"leftValueReference":["vAssignmentCollections"],"operator":["IsNull"],"rightValue":[{"booleanValue":["false"]}]}],"connector":[{"targetReference":["Update_All_Assignments_on_Project"]}],"label":["If Not Null"]}]},{"name":["Check_if_Project_fix_fee_field_is_changed"],"label":["Check if Project fix fee field is changed"],"locationX":["402"],"locationY":["3419"],"defaultConnectorLabel":["Default Outcome"],"rules":[{"name":["Values_changed_from_True_to_False"],"conditionLogic":["and"],"conditions":[{"leftValueReference":["$Record.FFPSA_IsFixedPriceFeeProject__c"],"operator":["IsChanged"],"rightValue":[{"booleanValue":["true"]}]},{"leftValueReference":["$Record.FFPSA_IsFixedPriceFeeProject__c"],"operator":["EqualTo"],"rightValue":[{"booleanValue":["false"]}]}],"connector":[{"targetReference":["Get_Assignments_from_Project_for_Fixfee"]}],"label":["Values changed from True to False"]},{"name":["Values_changed_from_False_to_True"],"conditionLogic":["and"],"conditions":[{"leftValueReference":["$Record.FFPSA_IsFixedPriceFeeProject__c"],"operator":["IsChanged"],"rightValue":[{"booleanValue":["true"]}]},{"leftValueReference":["$Record.FFPSA_IsFixedPriceFeeProject__c"],"operator":["EqualTo"],"rightValue":[{"booleanValue":["true"]}]}],"connector":[{"targetReference":["Get_Assignments_from_Project_for_FixfeeV2"]}],"label":["Values changed from False to True"]}]},{"name":["Check_Previous_ID"],"label":["Check Previous ID"],"locationX":["336"],"locationY":["2027"],"defaultConnector":[{"targetReference":["Assign_Current_ID"]}],"defaultConnectorLabel":["Default Outcome"],"rules":[{"name":["No"],"conditionLogic":["and"],"conditions":[{"leftValueReference":["previousresourceid"],"operator":["NotEqualTo"],"rightValue":[{"elementReference":["GetUserList.Id"]}]},{"leftValueReference":["GetResourceDetails.pse__Salesforce_User__c"],"operator":["IsNull"],"rightValue":[{"booleanValue":["false"]}]}],"connector":[{"targetReference":["CustomNotificationType"]}],"label":["No"]}]},{"description":["Decision will check if the project has reached the \"Soft Close/Delivered\" stage and if it has and the Region allows Closed for Expense Entry then this decision will become true"],"name":["FFPSA_Project_Region_Enabled_to_Close_Expense_Entry"],"label":["Project Region - Enabled to Close Expense Entry"],"locationX":["402"],"locationY":["3119"],"defaultConnector":[{"targetReference":["Check_if_Project_fix_fee_field_is_changed"]}],"defaultConnectorLabel":["Default Outcome"],"rules":[{"name":["FFPSA_Region_Closed_for_Expense_Entry"],"conditionLogic":["and"],"conditions":[{"leftValueReference":["$Record.pse__Region__r.FFPSA_SoftCloseClosedforExpenseEntry__c"],"operator":["EqualTo"],"rightValue":[{"booleanValue":["true"]}]},{"leftValueReference":["$Record.pse__Stage__c"],"operator":["EqualTo"],"rightValue":[{"stringValue":["Soft Close/Delivered"]}]},{"leftValueReference":["$Record.pse__Stage__c"],"operator":["NotEqualTo"],"rightValue":[{"elementReference":["$Record__Prior.pse__Stage__c"]}]}],"connector":[{"targetReference":["FFPSA_Project_Soft_Close_Closed_for_Expense_Entry"]}],"doesRequireRecordChangedToMeetCriteria":["true"],"label":["Region - Closed for Expense Entry"]}]},{"description":["Decision will check if the project has reached the \"Soft Close/Delivered\" stage and if it has and the Region allows Closed for Time Entry then this decision will become true"],"name":["FFPSA_Project_Region_Enabled_to_Close_Timecards"],"label":["Project Region - Enabled to Close Timecards"],"locationX":["402"],"locationY":["947"],"defaultConnector":[{"targetReference":["FFPSA_Project_Region_Enabled_to_Close_Expense_Entry"]}],"defaultConnectorLabel":["Default Outcome"],"rules":[{"name":["FFPSA_Region_Closed_for_Time_Entry"],"conditionLogic":["and"],"conditions":[{"leftValueReference":["$Record.pse__Region__r.FFPSA_SoftCloseClosedforTimeEntry__c"],"operator":["EqualTo"],"rightValue":[{"booleanValue":["true"]}]},{"leftValueReference":["$Record.pse__Stage__c"],"operator":["EqualTo"],"rightValue":[{"stringValue":["Soft Close/Delivered"]}]},{"leftValueReference":["$Record.pse__Stage__c"],"operator":["NotEqualTo"],"rightValue":[{"elementReference":["$Record__Prior.pse__Stage__c"]}]}],"connector":[{"targetReference":["FFPSA_Project_Soft_Close_Closed_for_Time_Entry"]}],"label":["Region - Closed for Time Entry"]}]},{"name":["Purchase_Order_added_Update_Work_At_Risk"],"label":["Purchase Order added - Update Work At Risk"],"locationX":["402"],"locationY":["323"],"defaultConnector":[{"targetReference":["FFPSA_Project_Region_Enabled_to_Close_Timecards"]}],"defaultConnectorLabel":["Default Outcome"],"rules":[{"name":["PO_added"],"conditionLogic":["and"],"conditions":[{"leftValueReference":["$Record.FFPSA_ProjectPurchaseOrderExists__c"],"operator":["EqualTo"],"rightValue":[{"stringValue":["PO exists"]}]},{"leftValueReference":["$Record.FFPSA_ProjectPurchaseOrderExists__c"],"operator":["NotEqualTo"],"rightValue":[{"elementReference":["$Record__Prior.FFPSA_ProjectPurchaseOrderExists__c"]}]},{"leftValueReference":["$Record.FFPSA_WARCount__c"],"operator":["GreaterThan"],"rightValue":[{"numberValue":["0.0"]}]}],"connector":[{"targetReference":["Get_Active_Renewed_Work_At_Risks"]}],"label":["PO added"]}]},{"name":["SoftCloseNotificationEnabled"],"label":["SoftCloseNotificationEnabled"],"locationX":["248"],"locationY":["1163"],"defaultConnector":[{"targetReference":["FFPSA_Project_Region_Enabled_to_Close_Expense_Entry"]}],"defaultConnectorLabel":["Default Outcome"],"rules":[{"name":["Yes"],"conditionLogic":["and"],"conditions":[{"leftValueReference":["$Record.pse__Region__r.FFPSA_SoftCloseProjectNotification__c"],"operator":["EqualTo"],"rightValue":[{"booleanValue":["true"]}]}],"connector":[{"targetReference":["FFPSA_Get_Assignments_from_Project"]}],"label":["Yes"]}]}],"description":["This flow is used for any UPDATES ONLY that takes place on Projects\nAdded notifications to be sent to project members. This will take into account the Soft Close - Notification checkbox on the region\nIssue 259727 - Sets the Record Owner to the PM is the Owner is different to the PM user and also if the PM field is filled in.\nAdded updates on related Project Work At Risk record's Approval Status, if PO is added to Project.\nV12: Added Bypass\nAdded : Update BillrateFixFee on assignment if FixFee on project is updated"],"environments":["Default"],"formulas":[{"name":["ClosedForTimecardNotification"],"dataType":["String"],"expression":["'Please note that Project '+{!$Record.Name}+' has been closed for time entry. No further time can be logged. Please contact the project manager.'"]},{"name":["PMUserID"],"dataType":["String"],"expression":["{!$Record.pse__Project_Manager__r.pse__Salesforce_User__r.id}"]}],"interviewLabel":["FFPSA - Project After Update Master Flowv1 {!$Flow.CurrentDateTime}"],"label":["FFPSA - Project After Update Master Flow"],"loops":[{"name":["FFPSA_Loop_through_Assignments"],"label":["Loop through Assignments"],"locationX":["116"],"locationY":["1595"],"collectionReference":["ResourcesFromAssignments"],"iterationOrder":["Asc"],"nextValueConnector":[{"targetReference":["GetResourceDetails"]}],"noMoreValuesConnector":[{"targetReference":["FFPSA_Project_Region_Enabled_to_Close_Expense_Entry"]}]},{"name":["Loop_through_Assignments_on_project"],"label":["Loop through Assignments on project"],"locationX":["50"],"locationY":["3635"],"collectionReference":["Get_Assignments_from_Project_for_Fixfee"],"iterationOrder":["Asc"],"nextValueConnector":[{"targetReference":["Populate_field_BillRateFixFee_on_Assignment_as_0"]}],"noMoreValuesConnector":[{"isGoTo":["true"],"targetReference":["Check_If_Assignments_are_not_null"]}]},{"name":["Loop_through_Assignments_on_projectV2"],"label":["Loop through Assignments on project"],"locationX":["446"],"locationY":["3635"],"collectionReference":["Get_Assignments_from_Project_for_FixfeeV2"],"iterationOrder":["Asc"],"nextValueConnector":[{"targetReference":["Populate_BillRateFixFee_on_Assignment_from_Suggested_Bill_Rate"]}],"noMoreValuesConnector":[{"targetReference":["Check_If_Assignments_are_not_null"]}]}],"processMetadataValues":[{"name":["BuilderType"],"value":[{"stringValue":["LightningFlowBuilder"]}]},{"name":["CanvasMode"],"value":[{"stringValue":["AUTO_LAYOUT_CANVAS"]}]},{"name":["OriginBuilderType"],"value":[{"stringValue":["LightningFlowBuilder"]}]}],"processType":["AutoLaunchedFlow"],"recordLookups":[{"name":["Custom_Notification_Type"],"label":["Custom Notification Type"],"locationX":["336"],"locationY":["1919"],"assignNullValuesIfNoRecordsFound":["false"],"connector":[{"targetReference":["Check_Previous_ID"]}],"filterLogic":["and"],"filters":[{"field":["DeveloperName"],"operator":["EqualTo"],"value":[{"stringValue":["FFPSA_ProjectClosedforTimecards"]}]}],"getFirstRecordOnly":["true"],"object":["CustomNotificationType"],"storeOutputAutomatically":["true"]},{"description":["Retrieve all assignments that relate to the project triggering this flow"],"name":["FFPSA_Get_Assignments_from_Project"],"label":["Get Assignments from Project"],"locationX":["116"],"locationY":["1271"],"assignNullValuesIfNoRecordsFound":["false"],"connector":[{"targetReference":["AssignmentsFromProject"]}],"filterLogic":["and"],"filters":[{"field":["pse__Project__c"],"operator":["EqualTo"],"value":[{"elementReference":["$Record.Id"]}]}],"getFirstRecordOnly":["false"],"object":["pse__Assignment__c"],"sortField":["pse__Resource__c"],"sortOrder":["Asc"],"storeOutputAutomatically":["true"]},{"name":["Get_Active_Renewed_Work_At_Risks"],"label":["Get Active/Renewed Work At Risks"],"locationX":["270"],"locationY":["431"],"assignNullValuesIfNoRecordsFound":["false"],"connector":[{"targetReference":["Approval_Status_WAR_Closed"]}],"filterLogic":["(1 OR 2) AND 3"],"filters":[{"field":["FFPSA_ApprovalStatus__c"],"operator":["EqualTo"],"value":[{"stringValue":["WAR active"]}]},{"field":["FFPSA_ApprovalStatus__c"],"operator":["EqualTo"],"value":[{"stringValue":["WAR renewed"]}]},{"field":["FFPSA_Project__c"],"operator":["EqualTo"],"value":[{"elementReference":["$Record.Id"]}]}],"getFirstRecordOnly":["true"],"object":["FFPSA_ProjectWorkAtRisk__c"],"queriedFields":["Id","FFPSA_ApprovalStatus__c","FFPSA_Project__c"],"storeOutputAutomatically":["true"]},{"description":["Retrieve all assignments that relate to the project triggering this flow"],"name":["Get_Assignments_from_Project_for_Fixfee"],"label":["Get Assignments from Project for Fixfee"],"locationX":["50"],"locationY":["3527"],"assignNullValuesIfNoRecordsFound":["false"],"connector":[{"targetReference":["Loop_through_Assignments_on_project"]}],"filterLogic":["and"],"filters":[{"field":["pse__Project__c"],"operator":["EqualTo"],"value":[{"elementReference":["$Record.Id"]}]}],"getFirstRecordOnly":["false"],"object":["pse__Assignment__c"],"queriedFields":["Id","pse__Suggested_Bill_Rate_Number__c","pse__Suggested_Bill_Rate__c","FFPSA_BillRateFixFee__c"],"storeOutputAutomatically":["true"]},{"description":["Retrieve all assignments that relate to the project triggering this flow"],"name":["Get_Assignments_from_Project_for_FixfeeV2"],"label":["Get Assignments from Project for Fixfee"],"locationX":["446"],"locationY":["3527"],"assignNullValuesIfNoRecordsFound":["false"],"connector":[{"targetReference":["Loop_through_Assignments_on_projectV2"]}],"filterLogic":["and"],"filters":[{"field":["pse__Project__c"],"operator":["EqualTo"],"value":[{"elementReference":["$Record.Id"]}]},{"field":["pse__Is_Billable__c"],"operator":["EqualTo"],"value":[{"booleanValue":["true"]}]}],"getFirstRecordOnly":["false"],"object":["pse__Assignment__c"],"queriedFields":["Id","pse__Suggested_Bill_Rate_Number__c","pse__Suggested_Bill_Rate__c","FFPSA_BillRateFixFee__c"],"storeOutputAutomatically":["true"]},{"name":["GetResourceDetails"],"label":["GetResourceDetails"],"locationX":["336"],"locationY":["1703"],"assignNullValuesIfNoRecordsFound":["false"],"connector":[{"targetReference":["GetUserList"]}],"filterLogic":["and"],"filters":[{"field":["Id"],"operator":["EqualTo"],"value":[{"elementReference":["FFPSA_Loop_through_Assignments.pse__Resource__c"]}]}],"getFirstRecordOnly":["true"],"object":["Contact"],"queriedFields":["Id","pse__Salesforce_User__c"],"sortField":["Id"],"sortOrder":["Asc"],"storeOutputAutomatically":["true"]},{"name":["GetUserList"],"label":["GetUserList"],"locationX":["336"],"locationY":["1811"],"assignNullValuesIfNoRecordsFound":["false"],"connector":[{"targetReference":["Custom_Notification_Type"]}],"filterLogic":["and"],"filters":[{"field":["Id"],"operator":["EqualTo"],"value":[{"elementReference":["GetResourceDetails.pse__Salesforce_User__c"]}]}],"getFirstRecordOnly":["true"],"object":["User"],"sortField":["Id"],"sortOrder":["Asc"],"storeOutputAutomatically":["true"]}],"recordUpdates":[{"name":["FFPSA_Project_Soft_Close_Closed_for_Expense_Entry"],"label":["Project Soft Close - Closed for Expense Entry"],"locationX":["270"],"locationY":["3227"],"connector":[{"targetReference":["Check_if_Project_fix_fee_field_is_changed"]}],"inputAssignments":[{"field":["pse__Closed_for_Expense_Entry__c"],"value":[{"booleanValue":["true"]}]}],"inputReference":["$Record"]},{"description":["Set the project that triggered this flow to be \"Closed for Time Entry\""],"name":["FFPSA_Project_Soft_Close_Closed_for_Time_Entry"],"label":["Project Soft Close - Closed for Time Entry"],"locationX":["248"],"locationY":["1055"],"connector":[{"targetReference":["SoftCloseNotificationEnabled"]}],"inputAssignments":[{"field":["pse__Closed_for_Time_Entry__c"],"value":[{"booleanValue":["true"]}]}],"inputReference":["$Record"]},{"name":["Update_All_Assignments_on_Project"],"label":["Update All Assignments on Project"],"locationX":["314"],"locationY":["4043"],"inputReference":["vAssignmentCollections"]},{"name":["Update_Proj_Work_At_Risk_Status"],"label":["Update Proj Work At Risk Status"],"locationX":["270"],"locationY":["755"],"connector":[{"targetReference":["FFPSA_Project_Region_Enabled_to_Close_Timecards"]}],"inputAssignments":[{"field":["FFPSA_WorkAtRiskStatus__c"],"value":[{"stringValue":["WAR closed"]}]}],"inputReference":["$Record"]},{"name":["Update_ProjWARs"],"label":["Update ProjWARs"],"locationX":["270"],"locationY":["647"],"connector":[{"targetReference":["Update_Proj_Work_At_Risk_Status"]}],"inputReference":["Get_Active_Renewed_Work_At_Risks"]}],"start":[{"locationX":["276"],"locationY":["0"],"connector":[{"targetReference":["Purchase_Order_added_Update_Work_At_Risk"]}],"filterFormula":["NOT({!$Permission.G_BypassFlowTrigger})"],"object":["pse__Proj__c"],"recordTriggerType":["Update"],"triggerType":["RecordAfterSave"]}],"status":["Active"],"variables":[{"name":["CustomerNotificationTypeID"],"dataType":["String"],"isCollection":["false"],"isInput":["false"],"isOutput":["false"]},{"name":["NotificationBodyText"],"dataType":["String"],"isCollection":["false"],"isInput":["false"],"isOutput":["false"]},{"name":["previousresourceid"],"dataType":["String"],"isCollection":["false"],"isInput":["false"],"isOutput":["false"]},{"name":["ResourceEmailAddresses"],"dataType":["SObject"],"isCollection":["true"],"isInput":["false"],"isOutput":["false"],"objectType":["Contact"]},{"name":["ResourcesFromAssignments"],"dataType":["SObject"],"isCollection":["true"],"isInput":["false"],"isOutput":["false"],"objectType":["pse__Assignment__c"]},{"name":["SFUserList"],"dataType":["SObject"],"isCollection":["true"],"isInput":["false"],"isOutput":["false"],"objectType":["User"]},{"name":["SFUserListTXT"],"dataType":["String"],"isCollection":["true"],"isInput":["false"],"isOutput":["false"]},{"name":["vAssignmentCollections"],"dataType":["SObject"],"isCollection":["true"],"isInput":["false"],"isOutput":["false"],"objectType":["pse__Assignment__c"]}]}}